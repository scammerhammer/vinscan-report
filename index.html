<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing Your Request...</title>
    <script>
        function logIPAndRedirect(targetPage) {
            fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                let ip = data.ip;
                let userAgent = navigator.userAgent;
                let pageUrl = window.location.href;
                let logData = {
                    "IP Address": ip,
                    "User Agent": userAgent,
                    "Page URL": pageUrl,
                    "Timestamp": new Date().toISOString()
                };

                fetch('https://formspree.io/f/mdkabale', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(logData)
                }).then(() => {
                    setTimeout(() => {
                        window.location.href = targetPage;
                    }, 1500); // Wait 1.5 seconds to ensure Formspree logs before redirecting
                });
            });
        }
    </script>
</head>
<body>
    <h2>Loading Your Request...</h2>
    <p>Please wait while we process your request.</p>

    <script>
        // Check URL parameters to determine which page to redirect to
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('receipt')) {
            logIPAndRedirect('receipt.html');
        } else if (urlParams.has('vinreport')) {
            logIPAndRedirect('vinreport.html');
        } else {
            logIPAndRedirect('default.html'); // Default redirect page
        }
    </script>
</body>
</html>


